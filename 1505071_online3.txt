---2
SELECT L.CITY,COUNT(E.EMPLOYEE_ID)
FROM EMPLOYEES E,DEPARTMENTS D,LOCATIONS L
WHERE E.EMPLOYEE_ID=D.DEPARTMENT_ID AND D.LOCATION_ID=L.LOCATION_ID
GROUP BY L.LOCATION_ID,L.CITY;
--1
SELECT C.COUNTRY_NAME,COUNT(*)
FROM EMPLOYEES E JOIN DEPARTMENTS D 
ON(E.EMPLOYEE_ID=D.DEPARTMENT_ID)
JOIN LOCATIONS L
ON(D.LOCATION_ID=L.LOCATION_ID)
LEFT OUTER JOIN COUNTRIES C
ON(L.COUNTRY_ID=C.COUNTRY_ID)
GROUP BY C.COUNTRY_ID,C.COUNTRY_NAME;
 

--4
SELECT E1.LAST_NAME
FROM EMPLOYEES E1
WHERE 3<=(SELECT C0UNT(*)
FROM EMPLOYEES E2
WHERE E2.SALARY<E1.SALARY AND E1.DEPARTMENT_ID=E2.DEPARTMENT_ID);



--3
SELECT E1.LAST_NAME,E1.JOB_ID
FROM EMPLOYEES E1 ,(SELECT AVG(E2.SALARY)
FROM EMPLOYEES E2
WHERE E1.JOB_ID=E2.JOB_ID) AVER
WHERE E1.SALARY IS BETWEEN AVER+1000 AND AVER -1000;
